/*! For license information please see functions.js.LICENSE.txt */
!function(){"use strict";var t={};function n(){var t,o,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function u(n,r,a,i){var u=r&&r.prototype instanceof s?r:s,l=Object.create(u.prototype);return e(l,"_invoke",function(n,e,r){var a,i,u,s=0,l=r||[],p=!1,f={p:0,n:0,v:t,a:I,f:I.bind(t,4),d:function(n,e){return a=n,i=0,u=t,f.n=e,c}};function I(n,e){for(i=n,u=e,o=0;!p&&s&&!r&&o<l.length;o++){var r,a=l[o],I=f.p,m=a[2];n>3?(r=m===e)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=I&&((r=n<2&&I<a[1])?(i=0,f.v=e,f.n=a[1]):I<m&&(r=n<3||a[0]>e||e>m)&&(a[4]=n,a[5]=e,f.n=m,i=0))}if(r||n>1)return c;throw p=!0,e}return function(r,l,m){if(s>1)throw TypeError("Generator is already running");for(p&&1===l&&I(l,m),i=l,u=m;(o=i<2?t:u)||!p;){a||(i?i<3?(i>1&&(f.n=-1),I(i,u)):f.n=u:f.v=u);try{if(s=2,a){if(i||(r="next"),o=a[r]){if(!(o=o.call(a,u)))throw TypeError("iterator result is not an object");if(!o.done)return o;u=o.value,i<2&&(i=0)}else 1===i&&(o=a.return)&&o.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=t}else if((o=(p=f.n<0)?u:n.call(e,f))!==c)break}catch(n){a=t,i=1,u=n}finally{s=1}}return{value:o,done:p}}}(n,a,i),!0),l}var c={};function s(){}function l(){}function p(){}o=Object.getPrototypeOf;var f=[][a]?o(o([][a]())):(e(o={},a,function(){return this}),o),I=p.prototype=s.prototype=Object.create(f);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,e(t,i,"GeneratorFunction")),t.prototype=Object.create(I),t}return l.prototype=p,e(I,"constructor",p),e(p,"constructor",l),l.displayName="GeneratorFunction",e(p,i,"GeneratorFunction"),e(I),e(I,i,"Generator"),e(I,a,function(){return this}),e(I,"toString",function(){return"[object Generator]"}),(n=function(){return{w:u,m:m}})()}function e(t,n,o,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}e=function(t,n,o,r){if(n)a?a(t,n,{value:o,enumerable:!r,configurable:!r,writable:!r}):t[n]=o;else{var i=function(n,o){e(t,n,function(t){return this._invoke(n,o,t)})};i("next",0),i("throw",1),i("return",2)}},e(t,n,o,r)}function o(t,n,e,o,r,a,i){try{var u=t[a](i),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(o,r)}function r(t){return function(){var n=this,e=arguments;return new Promise(function(r,a){var i=t.apply(n,e);function u(t){o(i,r,a,u,c,"next",t)}function c(t){o(i,r,a,u,c,"throw",t)}u(void 0)})}}function a(){return(new Date).toLocaleTimeString()}function i(){return i=r(n().m(function t(){return n().w(function(t){for(;;)if(0===t.n)return Excel.run(function(){var t=r(n().m(function t(e){return n().w(function(t){for(;;)switch(t.n){case 0:return e.workbook.worksheets.getActiveWorksheet().getRange("A1").values=[["Hello"]],t.n=1,e.sync();case 1:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()),t.a(2,"test")},t)})),i.apply(this,arguments)}function u(){return u=r(n().m(function t(){var e;return n().w(function(t){for(;;)switch(t.n){case 0:return e="Initial value",t.n=1,Excel.run(function(){var t=r(n().m(function t(o){var r,a;return n().w(function(t){for(;;)switch(t.n){case 0:return r=o.workbook.worksheets.getActiveWorksheet(),(a=r.getRange("A1")).load("values"),t.n=1,o.sync();case 1:console.log(a.values[0][0]),e=a.values[0][0]||"No value found";case 2:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}());case 1:return t.a(2,e)}},t)})),u.apply(this,arguments)}function c(){return(c=r(n().m(function t(e){var o,r,a,i,u;return n().w(function(t){for(;;)switch(t.n){case 0:(o=new Excel.RequestContext).setInvocation(e),r="Initial value",a=0;case 1:if(!(a<10)){t.n=4;break}return i=o.workbook.worksheets.getActiveWorksheet(),(u=i.getRange("A1")).load("values"),t.n=2,o.sync();case 2:r=u.values[0][0]||"No value found";case 3:a++,t.n=1;break;case 4:return t.a(2,r)}},t)}))).apply(this,arguments)}function s(){return(s=r(n().m(function t(e,o){return n().w(function(t){for(;;)if(0===t.n)return(new Excel.RequestContext).setInvocation(o),t.a(2,new Promise(function(t){setTimeout(function(){t("Waited ".concat(e," seconds"))},1e3*e)}))},t)}))).apply(this,arguments)}function l(){return(l=r(n().m(function t(e){var o;return n().w(function(t){for(;;)switch(t.n){case 0:return(o=new Excel.RequestContext).setInvocation(e),o.workbook.worksheets.getActiveWorksheet().getRange("A1").values=[["Hello"]],t.n=1,o.sync();case 1:return t.a(2,"test")}},t)}))).apply(this,arguments)}function p(){return(p=r(n().m(function t(e){var o,r;return n().w(function(t){for(;;)switch(t.p=t.n){case 0:return(o=new Excel.RequestContext).setInvocation(e),t.p=1,o.workbook.worksheets.getActiveWorksheet().getRange("A1").values=[["Hello"]],t.n=2,o.sync();case 2:t.n=4;break;case 3:return t.p=3,r=t.v,console.error(r),t.a(2,"test-error");case 4:return t.a(2,"test")}},t,null,[[1,3]])}))).apply(this,arguments)}function f(){return(f=r(n().m(function t(e){var o,r,a,i;return n().w(function(t){for(;;)switch(t.n){case 0:return(o=new Excel.RequestContext).setInvocation(e),r="Initial value",a=o.workbook.worksheets.getActiveWorksheet(),(i=a.getRange("A1")).load("values"),t.n=1,o.sync();case 1:return console.log(i.values[0][0]),r=i.values[0][0]||"No value found",t.a(2,r)}},t)}))).apply(this,arguments)}function I(){return(I=r(n().m(function t(e,o,r){var a,i,u,c;return n().w(function(t){for(;;)switch(t.p=t.n){case 0:return(new Excel.RequestContext).setInvocation(r),a={type:"Error",errorType:"NotAvailable"},t.p=1,null===o&&(o=!1),console.log("Searching for ".concat(e,"...")),t.n=2,g(e,o);case 2:if(0!=(i=t.v).length){t.n=3;break}return t.a(2,[[a]]);case 3:return u=i.map(function(t){return[m(t)]}),t.a(2,u);case 4:t.p=4,c=t.v,console.error(c);case 5:return t.a(2)}},t,null,[[1,4]])}))).apply(this,arguments)}function m(t){var n={type:"Entity",text:t.productName,properties:{"Product ID":{type:"String",basicValue:t.productID.toString()||""},"Product Name":{type:"String",basicValue:t.productName||""},"Quantity Per Unit":{type:"String",basicValue:t.quantityPerUnit||""},"Unit Price":{type:"Double",basicValue:t.unitPrice,numberFormat:"$* #,##0.00"},Discontinued:{type:"Boolean",basicValue:t.discontinued||!1}},layouts:{card:{title:{property:"Product Name"},sections:[{layout:"List",properties:["Product ID"]},{layout:"List",title:"Quantity and price",collapsible:!0,collapsed:!1,properties:["Quantity Per Unit","Unit Price"]},{layout:"List",title:"Additional information",collapsed:!0,properties:["Discontinued"]}]}}};return t.productImage&&(n.properties.Image={type:"WebImage",address:t.productImage||""},n.layouts.card.mainImage={property:"Image"}),n}function g(t,n){var e=t.toUpperCase();return!0===n?d.filter(function(t){return t.productName.toUpperCase()===e}):d.filter(function(t){return t.productName.toUpperCase().indexOf(e)>=0})}t.d=function(n,e){for(var o in e)t.o(e,o)&&!t.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:e[o]})},t.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)};var d=[{productID:1,productName:"Chai",supplierID:1,categoryID:1,quantityPerUnit:"10 boxes x 20 bags",unitPrice:18,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Masala_Chai.JPG/320px-Masala_Chai.JPG"},{productID:2,productName:"Chang",supplierID:1,categoryID:1,quantityPerUnit:"24 - 12 oz bottles",unitPrice:19,discontinued:!1,productImage:""},{productID:3,productName:"Aniseed Syrup",supplierID:1,categoryID:2,quantityPerUnit:"12 - 550 ml bottles",unitPrice:10,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Maltose_syrup.jpg/185px-Maltose_syrup.jpg"},{productID:4,productName:"Chef Anton's Cajun Seasoning",supplierID:2,categoryID:2,quantityPerUnit:"48 - 6 oz jars",unitPrice:22,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Kruidenmengeling-spice.jpg/193px-Kruidenmengeling-spice.jpg"},{productID:5,productName:"Chef Anton's Gumbo Mix",supplierID:2,categoryID:2,quantityPerUnit:"36 boxes",unitPrice:21.35,discontinued:!0,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/4/45/Okra_in_a_Bowl_%28Unsplash%29.jpg/180px-Okra_in_a_Bowl_%28Unsplash%29.jpg"},{productID:6,productName:"Grandma's Boysenberry Spread",supplierID:3,categoryID:2,quantityPerUnit:"12 - 8 oz jars",unitPrice:25,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/10/Making_cranberry_sauce_-_in_the_jar.jpg/90px-Making_cranberry_sauce_-_in_the_jar.jpg"},{productID:7,productName:"Uncle Bob's Organic Dried Pears",supplierID:3,categoryID:7,quantityPerUnit:"12 - 1 lb pkgs.",unitPrice:30,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/f/fd/DriedPears.JPG/120px-DriedPears.JPG"},{productID:8,productName:"Northwoods Cranberry Sauce",supplierID:3,categoryID:2,quantityPerUnit:"12 - 12 oz jars",unitPrice:40,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/07/Making_cranberry_sauce_-_stovetop.jpg/90px-Making_cranberry_sauce_-_stovetop.jpg"},{productID:9,productName:"Mishi Kobe Niku",supplierID:4,categoryID:6,quantityPerUnit:"18 - 500 g pkgs.",unitPrice:97,discontinued:!0,productImage:""},{productID:10,productName:"Ikura",supplierID:4,categoryID:8,quantityPerUnit:"12 - 200 ml jars",unitPrice:31,discontinued:!1,productImage:""}];CustomFunctions.associate("ADD",function(t,n,e){return(new Excel.RequestContext).setInvocation(e),t+n}),CustomFunctions.associate("CLOCK",function(t){var n=setInterval(function(){var n=a();t.setResult(n)},1e3);t.onCanceled=function(){clearInterval(n)}}),CustomFunctions.associate("INCREMENT",function(t,n){var e=0,o=setInterval(function(){e+=t,n.setResult(e)},1e4);n.onCanceled=function(){clearInterval(o)}}),CustomFunctions.associate("LOG",function(t){return console.log(t),t}),CustomFunctions.associate("RETURNINT",function(t){(new Excel.RequestContext).setInvocation(t);var n=(new Date).toISOString();return console.log("[".concat(n,"] "),"Call returnInt."),Math.floor(10*Math.random())}),CustomFunctions.associate("RETURNINTPROMISE",function(t){(new Excel.RequestContext).setInvocation(t);var n=(new Date).toISOString();return console.log("[".concat(n,"] "),"Call returnIntPromise."),new Promise(function(t){setTimeout(function(){t(Math.floor(100*Math.random()))},1e3)})}),CustomFunctions.associate("RETURN42PROMISE",function(t){(new Excel.RequestContext).setInvocation(t);var n=(new Date).toISOString();return console.log("[".concat(n,"] "),"Call return42Promise."),new Promise(function(t){setTimeout(function(){t(42)},1e3)})}),CustomFunctions.associate("RETURNINTVOLATILE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnIntVolatile."),Math.floor(1e3*Math.random())}),CustomFunctions.associate("RETURN42VOLATILE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call return42Volatile."),42}),CustomFunctions.associate("RETURNSTRINGVOLATILE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnStringVolatile."),a()}),CustomFunctions.associate("RETURNSTRINGSTREAM5M",function(t){var n=a();t.setResult(n);var e=(new Date).toISOString();console.log("[".concat(e,"] "),"Call returnStringStream5m#1.");var o=setInterval(function(){n=a(),t.setResult(n),console.log("[".concat(n,"] "),"Call returnStringStream5m#2.")},3e5);t.onCanceled=function(){clearInterval(o)}}),CustomFunctions.associate("RETURNSTRINGSTREAM1S",function(t){var n=a();t.setResult(n);var e=(new Date).toISOString();console.log("[".concat(e,"] "),"Call returnStringStream1s#1.");var o=setInterval(function(){n=a(),t.setResult(n),console.log("[".concat(n,"] "),"Call returnStringStream1s#2.")},1e3);t.onCanceled=function(){clearInterval(o)}}),CustomFunctions.associate("RETURNTESTSTRINGSTREAM1S",function(t){t.setResult(123);var n=(new Date).toISOString();console.log("[".concat(n,"] "),"Call returnTestStringStream1s#1.");var e=setInterval(function(){var n=(new Date).toISOString();t.setResult(123),console.log("[".concat(n,"] "),"Call returnTestStringStream1s#2.")},1e3);t.onCanceled=function(){clearInterval(e)}}),CustomFunctions.associate("RETURNSTRINGDYNAMICARRAY",function(t){(new Excel.RequestContext).setInvocation(t);var n=(new Date).toISOString();return console.log("[".concat(n,"] "),"Call returnStringDynamicArray."),[[a(),a(),a()]]}),CustomFunctions.associate("RETURNSTRINGTESTDYNAMICARRAY",function(t){(new Excel.RequestContext).setInvocation(t);var n=(new Date).toISOString();return console.log("[".concat(n,"] "),"Call returnStringTestDynamicArray."),[["1","2","3"]]}),CustomFunctions.associate("RETURNSTRINGNESTED",function(t,n){(new Excel.RequestContext).setInvocation(n);var e=t[0],o=(new Date).toISOString();return console.log("[".concat(o,"] "),"Call returnStringNested."),e}),CustomFunctions.associate("RETURNSTRINGWAIT",function(t){(new Excel.RequestContext).setInvocation(t);var n=(new Date).toISOString();console.log("[".concat(n,"] "),"Call returnStringWait.");for(var e=0;e<1e11;e++);return n}),CustomFunctions.associate("RETURNSTRINGWAITVOLATILE",function(){var t=(new Date).toISOString();console.log("[".concat(t,"]"),"Call returnStringWaitVolatile.");for(var n=0;n<1e11;n++);return t}),CustomFunctions.associate("RETURNDOUBLECELLVALUE",function(t){return(new Excel.RequestContext).setInvocation(t),{type:"Double",basicValue:10,numberFormat:"0.00%"}}),CustomFunctions.associate("INPUTSTRING",function(t,n){(new Excel.RequestContext).setInvocation(n);var e=(new Date).toISOString();return console.log("[".concat(e,"]"),"Call inputString."),t}),CustomFunctions.associate("INPUTINTOPTIONAL",function(t,n,e,o){return(new Excel.RequestContext).setInvocation(o),null===e&&(e=0),t+n+e}),CustomFunctions.associate("INPUTINTREPEATING",function(t,n){return(new Excel.RequestContext).setInvocation(n),t.reduce(function(t,n){return t+n},0)/t.length}),CustomFunctions.associate("INPUTRANGEPARAMS",function(t,n){(new Excel.RequestContext).setInvocation(n);for(var e=Number.MIN_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,r=0;r<t.length;r++)for(var a=0;a<t[r].length;a++)t[r][a]>=e?(o=e,e=t[r][a]):t[r][a]>=o&&(o=t[r][a]);return o===Number.MIN_SAFE_INTEGER&&(o=null),o}),CustomFunctions.associate("INTPUTINVOCATION",function(t,n,e){return(new Excel.RequestContext).setInvocation(e),e.address}),CustomFunctions.associate("CALLWRITEAPI",function(){return i.apply(this,arguments)}),CustomFunctions.associate("CALLREADAPI",function(){return u.apply(this,arguments)}),CustomFunctions.associate("CALLCONTEXTSYNC10TIMES",function(t){return c.apply(this,arguments)}),CustomFunctions.associate("WAITXSECONDSPROMISE",function(t,n){return s.apply(this,arguments)}),CustomFunctions.associate("SYNCCALLWRITEAPI",function(t){return l.apply(this,arguments)}),CustomFunctions.associate("SYNCCALLWRITEAPICATCH",function(t){return p.apply(this,arguments)}),CustomFunctions.associate("SYNCCALLREADAPI",function(t){return f.apply(this,arguments)}),CustomFunctions.associate("PRODUCTSEARCH",function(t,n,e){return I.apply(this,arguments)})}();
//# sourceMappingURL=functions.js.map