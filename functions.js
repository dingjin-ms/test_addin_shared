/*! For license information please see functions.js.LICENSE.txt */
!function(){"use strict";var t={};function n(){var t,o,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",u=r.toStringTag||"@@toStringTag";function c(n,r,a,u){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return e(l,"_invoke",function(n,e,r){var a,u,c,s=0,l=r||[],f=!1,S={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(n,e){return a=n,u=0,c=t,S.n=e,i}};function v(n,e){for(u=n,c=e,o=0;!f&&s&&!r&&o<l.length;o++){var r,a=l[o],v=S.p,I=a[2];n>3?(r=I===e)&&(c=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=t):a[0]<=v&&((r=n<2&&v<a[1])?(u=0,S.v=e,S.n=a[1]):v<I&&(r=n<3||a[0]>e||e>I)&&(a[4]=n,a[5]=e,S.n=I,u=0))}if(r||n>1)return i;throw f=!0,e}return function(r,l,I){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,I),u=l,c=I;(o=u<2?t:c)||!f;){a||(u?u<3?(u>1&&(S.n=-1),v(u,c)):S.n=c:S.v=c);try{if(s=2,a){if(u||(r="next"),o=a[r]){if(!(o=o.call(a,c)))throw TypeError("iterator result is not an object");if(!o.done)return o;c=o.value,u<2&&(u=0)}else 1===u&&(o=a.return)&&o.call(a),u<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),u=1);a=t}else if((o=(f=S.n<0)?c:n.call(e,S))!==i)break}catch(n){a=t,u=1,c=n}finally{s=1}}return{value:o,done:f}}}(n,a,u),!0),l}var i={};function s(){}function l(){}function f(){}o=Object.getPrototypeOf;var S=[][a]?o(o([][a]())):(e(o={},a,function(){return this}),o),v=f.prototype=s.prototype=Object.create(S);function I(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,u,"GeneratorFunction")),t.prototype=Object.create(v),t}return l.prototype=f,e(v,"constructor",f),e(f,"constructor",l),l.displayName="GeneratorFunction",e(f,u,"GeneratorFunction"),e(v),e(v,u,"Generator"),e(v,a,function(){return this}),e(v,"toString",function(){return"[object Generator]"}),(n=function(){return{w:c,m:I}})()}function e(t,n,o,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}e=function(t,n,o,r){if(n)a?a(t,n,{value:o,enumerable:!r,configurable:!r,writable:!r}):t[n]=o;else{var u=function(n,o){e(t,n,function(t){return this._invoke(n,o,t)})};u("next",0),u("throw",1),u("return",2)}},e(t,n,o,r)}function o(t,n,e,o,r,a,u){try{var c=t[a](u),i=c.value}catch(t){return void e(t)}c.done?n(i):Promise.resolve(i).then(o,r)}function r(t){return function(){var n=this,e=arguments;return new Promise(function(r,a){var u=t.apply(n,e);function c(t){o(u,r,a,c,i,"next",t)}function i(t){o(u,r,a,c,i,"throw",t)}c(void 0)})}}function a(){return(new Date).toLocaleTimeString()}function u(){return u=r(n().m(function t(){return n().w(function(t){for(;;)if(0===t.n)return Excel.run(function(){var t=r(n().m(function t(e){return n().w(function(t){for(;;)switch(t.n){case 0:return e.workbook.worksheets.getActiveWorksheet().getRange("A1").values=[["Hello"]],t.n=1,e.sync();case 1:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()),t.a(2,"test")},t)})),u.apply(this,arguments)}function c(){return c=r(n().m(function t(){var e;return n().w(function(t){for(;;)switch(t.n){case 0:return e="Initial value",t.n=1,Excel.run(function(){var t=r(n().m(function t(o){var r,a;return n().w(function(t){for(;;)switch(t.n){case 0:return r=o.workbook.worksheets.getActiveWorksheet(),(a=r.getRange("A1")).load("values"),t.n=1,o.sync();case 1:console.log(a.values[0][0]),e=a.values[0][0]||"No value found";case 2:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}());case 1:return t.a(2,e)}},t)})),c.apply(this,arguments)}function i(){return i=r(n().m(function t(){var e;return n().w(function(t){for(;;)switch(t.n){case 0:return e="Initial value",t.n=1,Excel.run(function(){var t=r(n().m(function t(o){var r,a,u;return n().w(function(t){for(;;)switch(t.n){case 0:r=0;case 1:if(!(r<10)){t.n=4;break}return a=o.workbook.worksheets.getActiveWorksheet(),(u=a.getRange("A1")).load("values"),t.n=2,o.sync();case 2:e=u.values[0][0]||"No value found";case 3:r++,t.n=1;break;case 4:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}());case 1:return t.a(2,e)}},t)})),i.apply(this,arguments)}function s(){return(s=r(n().m(function t(e){return n().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(t){setTimeout(function(){t("Waited ".concat(e," seconds"))},1e3*e)}))},t)}))).apply(this,arguments)}t.d=function(n,e){for(var o in e)t.o(e,o)&&!t.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:e[o]})},t.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},CustomFunctions.associate("ADD",function(t,n){return t+n}),CustomFunctions.associate("CLOCK",function(t){var n=setInterval(function(){var n=a();t.setResult(n)},1e3);t.onCanceled=function(){clearInterval(n)}}),CustomFunctions.associate("INCREMENT",function(t,n){var e=0,o=setInterval(function(){e+=t,n.setResult(e)},1e4);n.onCanceled=function(){clearInterval(o)}}),CustomFunctions.associate("LOG",function(t){return console.log(t),t}),CustomFunctions.associate("RETURNINT",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnInt."),Math.floor(10*Math.random())}),CustomFunctions.associate("RETURNINTPROMISE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnIntPromise."),new Promise(function(t){setTimeout(function(){t(Math.floor(100*Math.random()))},1e3)})}),CustomFunctions.associate("RETURN42PROMISE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call return42Promise."),new Promise(function(t){setTimeout(function(){t(42)},1e3)})}),CustomFunctions.associate("RETURNINTVOLATILE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnIntVolatile."),Math.floor(1e3*Math.random())}),CustomFunctions.associate("RETURN42VOLATILE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call return42Volatile."),42}),CustomFunctions.associate("RETURNSTRINGVOLATILE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnStringVolatile."),a()}),CustomFunctions.associate("RETURNSTRINGSTREAM5M",function(t){var n=a();t.setResult(n);var e=(new Date).toISOString();console.log("[".concat(e,"] "),"Call returnStringStream5m#1.");var o=setInterval(function(){n=a(),t.setResult(n),console.log("[".concat(n,"] "),"Call returnStringStream5m#2.")},3e5);t.onCanceled=function(){clearInterval(o)}}),CustomFunctions.associate("RETURNSTRINGSTREAM1S",function(t){var n=a();t.setResult(n);var e=(new Date).toISOString();console.log("[".concat(e,"] "),"Call returnStringStream1s#1.");var o=setInterval(function(){n=a(),t.setResult(n),console.log("[".concat(n,"] "),"Call returnStringStream1s#2.")},1e3);t.onCanceled=function(){clearInterval(o)}}),CustomFunctions.associate("RETURNTESTSTRINGSTREAM1S",function(t){t.setResult(123);var n=(new Date).toISOString();console.log("[".concat(n,"] "),"Call returnTestStringStream1s#1.");var e=setInterval(function(){var n=(new Date).toISOString();t.setResult(123),console.log("[".concat(n,"] "),"Call returnTestStringStream1s#2.")},1e3);t.onCanceled=function(){clearInterval(e)}}),CustomFunctions.associate("RETURNSTRINGDYNAMICARRAY",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnStringDynamicArray."),[[a(),a(),a()]]}),CustomFunctions.associate("RETURNSTRINGTESTDYNAMICARRAY",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnStringTestDynamicArray."),[["1","2","3"]]}),CustomFunctions.associate("RETURNSTRINGNESTED",function(t){var n=t[0],e=(new Date).toISOString();return console.log("[".concat(e,"] "),"Call returnStringNested."),n}),CustomFunctions.associate("RETURNSTRINGWAIT",function(){var t=(new Date).toISOString();console.log("[".concat(t,"] "),"Call returnStringWait.");for(var n=0;n<1e11;n++);return t}),CustomFunctions.associate("RETURNSTRINGWAITVOLATILE",function(){var t=(new Date).toISOString();console.log("[".concat(t,"]"),"Call returnStringWaitVolatile.");for(var n=0;n<1e11;n++);return t}),CustomFunctions.associate("RETURNDOUBLECELLVALUE",function(){return{type:"Double",basicValue:10,numberFormat:"0.00%"}}),CustomFunctions.associate("INPUTSTRING",function(t){var n=(new Date).toISOString();return console.log("[".concat(n,"]"),"Call inputString."),t}),CustomFunctions.associate("INPUTINTOPTIONAL",function(t,n,e){return null===e&&(e=0),t+n+e}),CustomFunctions.associate("INPUTINTREPEATING",function(t){return t.reduce(function(t,n){return t+n},0)/t.length}),CustomFunctions.associate("INPUTRANGEPARAMS",function(t){for(var n=Number.MIN_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER,o=0;o<t.length;o++)for(var r=0;r<t[o].length;r++)t[o][r]>=n?(e=n,n=t[o][r]):t[o][r]>=e&&(e=t[o][r]);return e===Number.MIN_SAFE_INTEGER&&(e=null),e}),CustomFunctions.associate("INTPUTINVOCATION",function(t,n,e){return e.address}),CustomFunctions.associate("CALLWRITEAPI",function(){return u.apply(this,arguments)}),CustomFunctions.associate("CALLREADAPI",function(){return c.apply(this,arguments)}),CustomFunctions.associate("CALLCONTEXTSYNC10TIMES",function(){return i.apply(this,arguments)}),CustomFunctions.associate("WAITXSECONDSPROMISE",function(t){return s.apply(this,arguments)})}();
//# sourceMappingURL=functions.js.map