/*! For license information please see functions.js.LICENSE.txt */
!function(){"use strict";var t={};function n(){var t,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function u(n,o,a,i){var u=o&&o.prototype instanceof s?o:s,l=Object.create(u.prototype);return e(l,"_invoke",function(n,e,o){var a,i,u,s=0,l=o||[],p=!1,f={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return a=n,i=0,u=t,f.n=e,c}};function m(n,e){for(i=n,u=e,r=0;!p&&s&&!o&&r<l.length;r++){var o,a=l[r],m=f.p,g=a[2];n>3?(o=g===e)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=m&&((o=n<2&&m<a[1])?(i=0,f.v=e,f.n=a[1]):m<g&&(o=n<3||a[0]>e||e>g)&&(a[4]=n,a[5]=e,f.n=g,i=0))}if(o||n>1)return c;throw p=!0,e}return function(o,l,g){if(s>1)throw TypeError("Generator is already running");for(p&&1===l&&m(l,g),i=l,u=g;(r=i<2?t:u)||!p;){a||(i?i<3?(i>1&&(f.n=-1),m(i,u)):f.n=u:f.v=u);try{if(s=2,a){if(i||(o="next"),r=a[o]){if(!(r=r.call(a,u)))throw TypeError("iterator result is not an object");if(!r.done)return r;u=r.value,i<2&&(i=0)}else 1===i&&(r=a.return)&&r.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=t}else if((r=(p=f.n<0)?u:n.call(e,f))!==c)break}catch(n){a=t,i=1,u=n}finally{s=1}}return{value:r,done:p}}}(n,a,i),!0),l}var c={};function s(){}function l(){}function p(){}r=Object.getPrototypeOf;var f=[][a]?r(r([][a]())):(e(r={},a,function(){return this}),r),m=p.prototype=s.prototype=Object.create(f);function g(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,e(t,i,"GeneratorFunction")),t.prototype=Object.create(m),t}return l.prototype=p,e(m,"constructor",p),e(p,"constructor",l),l.displayName="GeneratorFunction",e(p,i,"GeneratorFunction"),e(m),e(m,i,"Generator"),e(m,a,function(){return this}),e(m,"toString",function(){return"[object Generator]"}),(n=function(){return{w:u,m:g}})()}function e(t,n,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}e=function(t,n,r,o){if(n)a?a(t,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[n]=r;else{var i=function(n,r){e(t,n,function(t){return this._invoke(n,r,t)})};i("next",0),i("throw",1),i("return",2)}},e(t,n,r,o)}function r(t,n,e,r,o,a,i){try{var u=t[a](i),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function o(t){return function(){var n=this,e=arguments;return new Promise(function(o,a){var i=t.apply(n,e);function u(t){r(i,o,a,u,c,"next",t)}function c(t){r(i,o,a,u,c,"throw",t)}u(void 0)})}}function a(){return(new Date).toLocaleTimeString()}function i(){return i=o(n().m(function t(){return n().w(function(t){for(;;)if(0===t.n)return Excel.run(function(){var t=o(n().m(function t(e){return n().w(function(t){for(;;)switch(t.n){case 0:return e.workbook.worksheets.getActiveWorksheet().getRange("A1").values=[["Hello"]],t.n=1,e.sync();case 1:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()),t.a(2,"test")},t)})),i.apply(this,arguments)}function u(){return u=o(n().m(function t(){var e;return n().w(function(t){for(;;)switch(t.n){case 0:return e="Initial value",t.n=1,Excel.run(function(){var t=o(n().m(function t(r){var o,a;return n().w(function(t){for(;;)switch(t.n){case 0:return o=r.workbook.worksheets.getActiveWorksheet(),(a=o.getRange("A1")).load("values"),t.n=1,r.sync();case 1:console.log(a.values[0][0]),e=a.values[0][0]||"No value found";case 2:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}());case 1:return t.a(2,e)}},t)})),u.apply(this,arguments)}function c(){return c=o(n().m(function t(){var e;return n().w(function(t){for(;;)switch(t.n){case 0:return e="Initial value",t.n=1,Excel.run(function(){var t=o(n().m(function t(r){var o,a,i;return n().w(function(t){for(;;)switch(t.n){case 0:o=0;case 1:if(!(o<10)){t.n=4;break}return a=r.workbook.worksheets.getActiveWorksheet(),(i=a.getRange("A1")).load("values"),t.n=2,r.sync();case 2:e=i.values[0][0]||"No value found";case 3:o++,t.n=1;break;case 4:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}());case 1:return t.a(2,e)}},t)})),c.apply(this,arguments)}function s(){return(s=o(n().m(function t(e){return n().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(t){setTimeout(function(){t("Waited ".concat(e," seconds"))},1e3*e)}))},t)}))).apply(this,arguments)}function l(){return(l=o(n().m(function t(e){var r;return n().w(function(t){for(;;)switch(t.n){case 0:return(r=new Excel.RequestContext).setInvocation(e),r.workbook.worksheets.getActiveWorksheet().getRange("A1").values=[["Hello"]],t.n=1,r.sync();case 1:return t.a(2,"test")}},t)}))).apply(this,arguments)}function p(){return(p=o(n().m(function t(e){var r,o,a,i;return n().w(function(t){for(;;)switch(t.n){case 0:return(r=new Excel.RequestContext).setInvocation(e),o="Initial value",a=r.workbook.worksheets.getActiveWorksheet(),(i=a.getRange("A1")).load("values"),t.n=1,r.sync();case 1:return console.log(i.values[0][0]),o=i.values[0][0]||"No value found",t.a(2,o)}},t)}))).apply(this,arguments)}function f(){return(f=o(n().m(function t(e,r){var o,a,i,u;return n().w(function(t){for(;;)switch(t.p=t.n){case 0:return o={type:"Error",errorType:"NotAvailable"},t.p=1,null===r&&(r=!1),console.log("Searching for ".concat(e,"...")),t.n=2,g(e,r);case 2:if(0!=(a=t.v).length){t.n=3;break}return t.a(2,[[o]]);case 3:return i=a.map(function(t){return[m(t)]}),t.a(2,i);case 4:t.p=4,u=t.v,console.error(u);case 5:return t.a(2)}},t,null,[[1,4]])}))).apply(this,arguments)}function m(t){var n={type:"Entity",text:t.productName,properties:{"Product ID":{type:"String",basicValue:t.productID.toString()||""},"Product Name":{type:"String",basicValue:t.productName||""},"Quantity Per Unit":{type:"String",basicValue:t.quantityPerUnit||""},"Unit Price":{type:"Double",basicValue:t.unitPrice,numberFormat:"$* #,##0.00"},Discontinued:{type:"Boolean",basicValue:t.discontinued||!1}},layouts:{card:{title:{property:"Product Name"},sections:[{layout:"List",properties:["Product ID"]},{layout:"List",title:"Quantity and price",collapsible:!0,collapsed:!1,properties:["Quantity Per Unit","Unit Price"]},{layout:"List",title:"Additional information",collapsed:!0,properties:["Discontinued"]}]}}};return t.productImage&&(n.properties.Image={type:"WebImage",address:t.productImage||""},n.layouts.card.mainImage={property:"Image"}),n}function g(t,n){var e=t.toUpperCase();return!0===n?d.filter(function(t){return t.productName.toUpperCase()===e}):d.filter(function(t){return t.productName.toUpperCase().indexOf(e)>=0})}t.d=function(n,e){for(var r in e)t.o(e,r)&&!t.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:e[r]})},t.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)};var d=[{productID:1,productName:"Chai",supplierID:1,categoryID:1,quantityPerUnit:"10 boxes x 20 bags",unitPrice:18,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Masala_Chai.JPG/320px-Masala_Chai.JPG"},{productID:2,productName:"Chang",supplierID:1,categoryID:1,quantityPerUnit:"24 - 12 oz bottles",unitPrice:19,discontinued:!1,productImage:""},{productID:3,productName:"Aniseed Syrup",supplierID:1,categoryID:2,quantityPerUnit:"12 - 550 ml bottles",unitPrice:10,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Maltose_syrup.jpg/185px-Maltose_syrup.jpg"},{productID:4,productName:"Chef Anton's Cajun Seasoning",supplierID:2,categoryID:2,quantityPerUnit:"48 - 6 oz jars",unitPrice:22,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Kruidenmengeling-spice.jpg/193px-Kruidenmengeling-spice.jpg"},{productID:5,productName:"Chef Anton's Gumbo Mix",supplierID:2,categoryID:2,quantityPerUnit:"36 boxes",unitPrice:21.35,discontinued:!0,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/4/45/Okra_in_a_Bowl_%28Unsplash%29.jpg/180px-Okra_in_a_Bowl_%28Unsplash%29.jpg"},{productID:6,productName:"Grandma's Boysenberry Spread",supplierID:3,categoryID:2,quantityPerUnit:"12 - 8 oz jars",unitPrice:25,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/10/Making_cranberry_sauce_-_in_the_jar.jpg/90px-Making_cranberry_sauce_-_in_the_jar.jpg"},{productID:7,productName:"Uncle Bob's Organic Dried Pears",supplierID:3,categoryID:7,quantityPerUnit:"12 - 1 lb pkgs.",unitPrice:30,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/f/fd/DriedPears.JPG/120px-DriedPears.JPG"},{productID:8,productName:"Northwoods Cranberry Sauce",supplierID:3,categoryID:2,quantityPerUnit:"12 - 12 oz jars",unitPrice:40,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/07/Making_cranberry_sauce_-_stovetop.jpg/90px-Making_cranberry_sauce_-_stovetop.jpg"},{productID:9,productName:"Mishi Kobe Niku",supplierID:4,categoryID:6,quantityPerUnit:"18 - 500 g pkgs.",unitPrice:97,discontinued:!0,productImage:""},{productID:10,productName:"Ikura",supplierID:4,categoryID:8,quantityPerUnit:"12 - 200 ml jars",unitPrice:31,discontinued:!1,productImage:""}];CustomFunctions.associate("ADD",function(t,n){return t+n}),CustomFunctions.associate("CLOCK",function(t){var n=setInterval(function(){var n=a();t.setResult(n)},1e3);t.onCanceled=function(){clearInterval(n)}}),CustomFunctions.associate("INCREMENT",function(t,n){var e=0,r=setInterval(function(){e+=t,n.setResult(e)},1e4);n.onCanceled=function(){clearInterval(r)}}),CustomFunctions.associate("LOG",function(t){return console.log(t),t}),CustomFunctions.associate("RETURNINT",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnInt."),Math.floor(10*Math.random())}),CustomFunctions.associate("RETURNINTPROMISE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnIntPromise."),new Promise(function(t){setTimeout(function(){t(Math.floor(100*Math.random()))},1e3)})}),CustomFunctions.associate("RETURN42PROMISE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call return42Promise."),new Promise(function(t){setTimeout(function(){t(42)},1e3)})}),CustomFunctions.associate("RETURNINTVOLATILE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnIntVolatile."),Math.floor(1e3*Math.random())}),CustomFunctions.associate("RETURN42VOLATILE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call return42Volatile."),42}),CustomFunctions.associate("RETURNSTRINGVOLATILE",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnStringVolatile."),a()}),CustomFunctions.associate("RETURNSTRINGSTREAM5M",function(t){var n=a();t.setResult(n);var e=(new Date).toISOString();console.log("[".concat(e,"] "),"Call returnStringStream5m#1.");var r=setInterval(function(){n=a(),t.setResult(n),console.log("[".concat(n,"] "),"Call returnStringStream5m#2.")},3e5);t.onCanceled=function(){clearInterval(r)}}),CustomFunctions.associate("RETURNSTRINGSTREAM1S",function(t){var n=a();t.setResult(n);var e=(new Date).toISOString();console.log("[".concat(e,"] "),"Call returnStringStream1s#1.");var r=setInterval(function(){n=a(),t.setResult(n),console.log("[".concat(n,"] "),"Call returnStringStream1s#2.")},1e3);t.onCanceled=function(){clearInterval(r)}}),CustomFunctions.associate("RETURNTESTSTRINGSTREAM1S",function(t){t.setResult(123);var n=(new Date).toISOString();console.log("[".concat(n,"] "),"Call returnTestStringStream1s#1.");var e=setInterval(function(){var n=(new Date).toISOString();t.setResult(123),console.log("[".concat(n,"] "),"Call returnTestStringStream1s#2.")},1e3);t.onCanceled=function(){clearInterval(e)}}),CustomFunctions.associate("RETURNSTRINGDYNAMICARRAY",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnStringDynamicArray."),[[a(),a(),a()]]}),CustomFunctions.associate("RETURNSTRINGTESTDYNAMICARRAY",function(){var t=(new Date).toISOString();return console.log("[".concat(t,"] "),"Call returnStringTestDynamicArray."),[["1","2","3"]]}),CustomFunctions.associate("RETURNSTRINGNESTED",function(t){var n=t[0],e=(new Date).toISOString();return console.log("[".concat(e,"] "),"Call returnStringNested."),n}),CustomFunctions.associate("RETURNSTRINGWAIT",function(){var t=(new Date).toISOString();console.log("[".concat(t,"] "),"Call returnStringWait.");for(var n=0;n<1e11;n++);return t}),CustomFunctions.associate("RETURNSTRINGWAITVOLATILE",function(){var t=(new Date).toISOString();console.log("[".concat(t,"]"),"Call returnStringWaitVolatile.");for(var n=0;n<1e11;n++);return t}),CustomFunctions.associate("RETURNDOUBLECELLVALUE",function(){return{type:"Double",basicValue:10,numberFormat:"0.00%"}}),CustomFunctions.associate("INPUTSTRING",function(t){var n=(new Date).toISOString();return console.log("[".concat(n,"]"),"Call inputString."),t}),CustomFunctions.associate("INPUTINTOPTIONAL",function(t,n,e){return null===e&&(e=0),t+n+e}),CustomFunctions.associate("INPUTINTREPEATING",function(t){return t.reduce(function(t,n){return t+n},0)/t.length}),CustomFunctions.associate("INPUTRANGEPARAMS",function(t){for(var n=Number.MIN_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER,r=0;r<t.length;r++)for(var o=0;o<t[r].length;o++)t[r][o]>=n?(e=n,n=t[r][o]):t[r][o]>=e&&(e=t[r][o]);return e===Number.MIN_SAFE_INTEGER&&(e=null),e}),CustomFunctions.associate("INTPUTINVOCATION",function(t,n,e){return e.address}),CustomFunctions.associate("CALLWRITEAPI",function(){return i.apply(this,arguments)}),CustomFunctions.associate("CALLREADAPI",function(){return u.apply(this,arguments)}),CustomFunctions.associate("CALLCONTEXTSYNC10TIMES",function(){return c.apply(this,arguments)}),CustomFunctions.associate("WAITXSECONDSPROMISE",function(t){return s.apply(this,arguments)}),CustomFunctions.associate("SYNCCALLWRITEAPI",function(t){return l.apply(this,arguments)}),CustomFunctions.associate("SYNCCALLREADAPI",function(t){return p.apply(this,arguments)}),CustomFunctions.associate("PRODUCTSEARCH",function(t,n){return f.apply(this,arguments)})}();
//# sourceMappingURL=functions.js.map